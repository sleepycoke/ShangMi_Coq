Require Import NArith.
Require Import Coq.PArith.BinPosDef. 
Require Import Coq.Strings.HexString. 
Require Import Ascii String. 
Require Import Coq.Strings.Ascii. 
Require Import Coq.Strings.String.
Import Coq.Lists.List.
Import ListNotations. 
Open Scope list_scope.
Open Scope string_scope.
Open Scope N_scope.
Definition boxlist :=
 [["6";"90";"e9";"fe";"cc";"e1";"3d";"b7";"16";"b6";"14";"c2";"28";"fb";"2c";"05"];
  ["2b";"67";"9a";"76";"2a";"be";"04";"c3";"aa";"44";"13";"26";"49";"86";"06";"99"];
  ["9c";"42";"50";"f4";"91";"ef";"98";"7a";"33";"54";"0b";"43";"e";"cf";"ac";"62"];
  ["e4";"b3";"1c";"a9";"c9";"08";"e8";"95";"80";"f";"94";"fa";"75";"8f";"3f";"a6"];
  ["47";"07";"a7";"fc";"f3";"73";"17";"ba";"83";"59";"3c";"19";"e6";"85";"4f";"a8"];
  ["68";"6b";"81";"b2";"71";"64";"a";"8b";"f8";"eb";"0f";"4b";"70";"56";"9d";"35"];
  ["1e";"24";"0e";"5e";"63";"58";"1";"a2";"25";"22";"7c";"3b";"01";"21";"78";"87"];
  ["4";"00";"46";"57";"9f";"d3";"27";"52";"4c";"36";"02";"e7";"a0";"c4";"c8";"9e"];
  ["ea";"bf";"8a";"2";"40";"c7";"38";"b5";"a3";"f7";"f2";"ce";"f9";"61";"15";"a1"];
  ["e0";"ae";"5";"a4";"9b";"34";"1a";"55";"ad";"93";"32";"30";"f5";"8c";"b1";"e3"];
  ["1";"f6";"e2";"2e";"82";"66";"ca";"60";"c0";"29";"23";"ab";"0d";"53";"4e";"6f"];
  ["5";"db";"37";"45";"de";"fd";"8e";"2f";"03";"ff";"6a";"72";"6d";"6c";"5b";"51"];
  ["8";"1b";"af";"92";"bb";"dd";"bc";"7f";"11";"d9";"5c";"41";"1f";"10";"5a";"d8"];
  ["0a";"c1";"31";"88";"a5";"c";"7b";"bd";"2d";"74";"d0";"12";"b8";"e5";"b4";"b0"];
  ["89";"69";"97";"4a";"0c";"96";"77";"7e";"65";"b9";"f1";"09";"c5";"6e";"c6";"84"];
  ["18";"f0";"7";"ec";"3a";"dc";"4d";"20";"79";"ee";"5f";"3e";"d7";"cb";"39";"48"]].

Definition Sbox (n : N) : N :=
  HexString.to_N ("0x" ++ (nth (N.to_nat (N.modulo n 16)) (nth (N.to_nat (N.div n 16)) boxlist []) "")). 
 
Definition FKlist := ["A3B1BAC6"; "56AA3350"; "677D9197"; "B27022DC"].

Definition FK (n : N) : N :=
  HexString.to_N ("0x" ++ (nth (N.to_nat n) FKlist "")). 
 
Definition CKlist := 
 ["00070e15"; "1c232a31"; "383f464"; "545b6269";
  "70777e85"; "8c939aa1"; "a8afb6b"; "c4cbd2d9";
  "e0e7eef5"; "fc030a11"; "181f262"; "343b4249";
  "50575e65"; "6c737a81"; "888f969"; "a4abb2b9";
  "c0c7ce5"; "dce3eaf1"; "f8ff060d"; "141b2229";
  "30373e45"; "4c535a61"; "686f767"; "848b9299";
  "a0a7aeb5"; "bcc3ca1"; "d8dfe6ed"; "f4fb0209";
  "10171e25"; "2c333a41"; "484f565"; "646b7279"]. 

Definition CK (n : N) : N :=
  HexString.to_N ("0x" ++ (nth (N.to_nat n) CKlist "")). 

Definition constant_v := 256%nat. (*Accoring to the examples. *)

Definition TPB_IRP := 
[(193, 15); (194, 87); (196, 3); (198, 9); (199, 34); (201, 14);
 (202, 55); (204, 27); (207, 43); (209, 6); (210, 7); (212, 105);
 (214, 73); (215, 23); (217, 45); (218, 11); (220, 7); (223, 33);
 (225, 32); (228, 113); (231, 26); (233, 74); (234, 31); (236, 5);
 (238, 73); (239, 36); (241, 70); (242, 95); (244, 111); (247, 82);
 (249, 35); (250, 103); (252, 15); (253, 46); (255, 52); (257, 12);
 (258, 71); (260, 15); (263, 93); (265, 42); (266, 47); (268, 25);
 (270, 53); (271, 58); (273, 23); (274, 67); (276, 63); (278, 5);
 (279, 5); (281, 93); (282, 35); (284, 53); (286, 69); (287, 71);
 (289, 21); (292, 37); (294, 33); (295, 48); (297, 5); (300, 5);
 (302, 41); (303, 1); (305, 102); (308, 15); (310, 93); (313, 79);
 (314, 15); (316, 63); (318, 45); (319, 36); (321, 31); (322, 67);
 (324, 51); (327, 34); (329, 50); (330, 99); (332, 89); (333, 2);
 (337, 55); (340, 45); (342, 125); (343, 75); (345, 22); (346, 63);
 (348, 103); (350, 53); (351, 34); (353, 69); (354, 99); (358, 57);
 (359, 68); (362, 63); (364, 9); (366, 29); (367, 21); (369, 91);
 (370, 139); (372, 111); (375, 16); (377, 41); (378, 43); (380, 47);
 (382, 81); (383, 90); (385, 6); (386, 83); (388, 159); (390, 9);
 (391, 28); (393, 7); (394, 135); (396, 25); (399, 26); (401, 152);
 (402, 171); (404, 65); (406, 141); (407, 71); (409, 87); (412, 147);
 (414, 13); (415, 102); (417, 107); (418, 199); (420, 7); (422, 149);
 (423, 25); (425, 12); (426, 63); (428, 105); (431, 120); (433, 33);
 (436, 165); (438, 65); (439, 49); (441, 7); (444, 81); (446, 105);
 (447, 73); (449, 134); (450, 47); (455, 38); (457, 16); (458, 203);
 (460, 19); (462, 73); (463, 93); (465, 31); (468, 27); (470, 9);
 (471, 1); (473, 200); (474, 191); (476, 9); (478, 121); (479, 104);
 (481, 138); (484, 105); (486, 81); (487, 94); (489, 83); (490, 219);
 (492, 7); (494, 17); (495, 76); (497, 78); (498, 155); (500, 27);
 (503, 3); (505, 156); (506, 23); (508, 9); (510, 69); (511, 10)]. 
 
Definition PPB_IRP := 
 [(192,(1,2,7)); (195,(1,2,37)); (197,(1,2,21)); (200,(1,2,81));
 (203,(1,2,45)); (205,(1,2,21)); (206,(1,2,63)); (208,(1,2,83));
 (211,(1,2,165)); (213,(1,2,62)); (216,(1,2,107)); (219,(1,2,65));
 (221,(1,2,18)); (222,(1,2,73)); (224,(1,2,159)); (226,(1,2,30));
 (227,(1,2,21)); (229,(1,2,21)); (230,(1,2,13)); (232,(1,2,23));
 (235,(1,2,45)); (237,(1,2,104)); (240,(1,3,49)); (243,(1,2,17));
 (245,(1,2,37)); (246,(1,2,11)); (248,(1,2,243)); (251,(1,2,45));
 (254,(1,2,7)); (256,(1,2,155)); (259,(1,2,254)); (261,(1,2,74));
 (262,(1,2,207)); (264,(1,2,169)); (267,(1,2,29)); (269,(1,2,117));
 (272,(1,3,56)); (275,(1,2,28)); (277,(1,2,33)); (280,(1,2,113));
 (283,(1,2,200)); (285,(1,2,77)); (288,(1,2,191)); (290,(1,2,70));
 (291,(1,2,76)); (293,(1,3,154)); (296,(1,2,123)); (298,(1,2,78));
 (299,(1,2,21)); (301,(1,2,26)); (304,(1,2,11)); (306,(1,2,106));
 (307,(1,2,93)); (309,(1,2,26)); (311,(1,3,155)); (312,(1,2,83));
 (315,(1,2,142)); (317,(1,3,68)); (320,(1,2,7)); (323,(1,2,21));
 (325,(1,2,53)); (326,(1,2,67)); (328,(1,2,51)); (331,(1,2,134));
 (334,(1,2,5)); (335,(1,2,250)); (336,(1,2,77)); (338,(1,2,112));
 (339,(1,2,26)); (341,(1,2,57)); (344,(1,2,7)); (347,(1,2,96));
 (349,(1,2,186)); (352,(1,2,263)); (355,(1,2,138)); (356,(1,2,69));
 (357,(1,2,28)); (360,(1,2,49)); (361,(1,2,44)); (363,(1,2,38));
 (365,(1,2,109)); (368,(1,2,85)); (371,(1,2,156)); (373,(1,3,172));
 (374,(1,2,109)); (376,(1,2,77)); (379,(1,2,222)); (381,(1,2,5));
 (384,(1,2,299)); (387,(1,2,146)); (389,(1,2,159)); (392,(1,2,145));
 (395,(1,2,333)); (397,(1,2,125)); (398,(1,3,23)); (400,(1,2,245));
 (403,(1,2,80)); (405,(1,2,38)); (408,(1,2,323)); (410,(1,2,16));
 (411,(1,2,50)); (413,(1,2,33)); (416,(1,3,76)); (419,(1,2,129));
 (421,(1,2,81)); (424,(1,2,177)); (427,(1,2,245)); (429,(1,2,14));
 (430,(1,2,263)); (432,(1,2,103)); (434,(1,2,64)); (435,(1,2,166));
 (437,(1,2,6)); (440,(1,2,37)); (442,(1,2,32)); (443,(1,2,57));
 (445,(1,2,225)); (448,(1,3,83)); (451,(1,2,33)); (452,(1,2,10));
 (453,(1,2,88)); (454,(1,2,195)); (456,(1,2,275)); (459,(1,2,332));
 (461,(1,2,247)); (464,(1,2,310)); (466,(1,2,78)); (467,(1,2,210));
 (469,(1,2,149)); (472,(1,2,33)); (475,(1,2,68)); (477,(1,2,121));
 (480,(1,2,149)); (482,(1,2,13)); (483,(1,2,352)); (485,(1,2,70));
 (488,(1,2,123)); (491,(1,2,270)); (493,(1,2,171)); (496,(1,3,52));
 (499,(1,2,174)); (501,(1,2,332)); (502,(1,2,99)); (504,(1,3,148));
 (507,(1,2,26)); (509,(1,2,94)); (512,(1,2,51))]. 
